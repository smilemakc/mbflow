{
  "workflow": {
    "name": "User Onboarding Workflow",
    "description": "Automated user onboarding when new user is created",
    "status": "active",
    "nodes": [
      {
        "id": "create_profile",
        "name": "Create User Profile",
        "type": "http",
        "config": {
          "method": "POST",
          "url": "https://api.example.com/profiles",
          "headers": {
            "Authorization": "Bearer {{.api_token}}",
            "Content-Type": "application/json"
          },
          "body": {
            "user_id": "{{.user_id}}",
            "email": "{{.email}}",
            "name": "{{.name}}",
            "created_at": "{{.created_at}}"
          }
        }
      },
      {
        "id": "send_welcome_email",
        "name": "Send Welcome Email",
        "type": "http",
        "config": {
          "method": "POST",
          "url": "https://api.sendgrid.com/v3/mail/send",
          "headers": {
            "Authorization": "Bearer {{.sendgrid_key}}",
            "Content-Type": "application/json"
          },
          "body": {
            "personalizations": [
              {
                "to": [
                  {
                    "email": "{{.email}}"
                  }
                ],
                "dynamic_template_data": {
                  "name": "{{.name}}",
                  "user_id": "{{.user_id}}"
                }
              }
            ],
            "from": {
              "email": "welcome@example.com"
            },
            "template_id": "{{.welcome_template_id}}"
          }
        }
      },
      {
        "id": "create_onboarding_tasks",
        "name": "Create Onboarding Tasks",
        "type": "http",
        "config": {
          "method": "POST",
          "url": "https://api.example.com/tasks/bulk",
          "headers": {
            "Authorization": "Bearer {{.api_token}}",
            "Content-Type": "application/json"
          },
          "body": {
            "user_id": "{{.user_id}}",
            "tasks": [
              {
                "title": "Complete profile",
                "description": "Add your profile picture and bio",
                "priority": "high"
              },
              {
                "title": "Explore features",
                "description": "Take a tour of our platform",
                "priority": "medium"
              },
              {
                "title": "Invite team members",
                "description": "Collaborate with your team",
                "priority": "low"
              }
            ]
          }
        }
      },
      {
        "id": "track_event",
        "name": "Track Onboarding Event",
        "type": "http",
        "config": {
          "method": "POST",
          "url": "https://api.segment.com/v1/track",
          "headers": {
            "Authorization": "Bearer {{.segment_key}}",
            "Content-Type": "application/json"
          },
          "body": {
            "userId": "{{.user_id}}",
            "event": "Onboarding Started",
            "properties": {
              "email": "{{.email}}",
              "source": "{{.source}}",
              "timestamp": "{{.created_at}}"
            }
          }
        }
      }
    ],
    "edges": [
      {
        "id": "e1",
        "from": "create_profile",
        "to": "send_welcome_email"
      },
      {
        "id": "e2",
        "from": "create_profile",
        "to": "create_onboarding_tasks"
      },
      {
        "id": "e3",
        "from": "send_welcome_email",
        "to": "track_event"
      }
    ],
    "variables": {
      "api_token": "your-api-token",
      "sendgrid_key": "your-sendgrid-key",
      "segment_key": "your-segment-key",
      "welcome_template_id": "d-xyz123"
    }
  },
  "trigger": {
    "name": "User Created Event",
    "description": "Triggers when a new user is created",
    "type": "event",
    "config": {
      "event_type": "user.created",
      "filter": {
        "source": "api",
        "status": "active"
      }
    },
    "enabled": true
  },
  "notes": {
    "publishing_events": [
      "To publish user creation events, use the event publishing API:",
      "",
      "POST /api/v1/events/publish",
      "{",
      "  \"type\": \"user.created\",",
      "  \"source\": \"api\",",
      "  \"data\": {",
      "    \"user_id\": \"123\",",
      "    \"email\": \"user@example.com\",",
      "    \"name\": \"John Doe\",",
      "    \"status\": \"active\",",
      "    \"created_at\": \"2024-01-01T00:00:00Z\"",
      "  }",
      "}"
    ],
    "filtering": [
      "The filter ensures only active users from API source trigger the workflow",
      "Events with source='webhook' or status='pending' will be ignored"
    ]
  }
}
